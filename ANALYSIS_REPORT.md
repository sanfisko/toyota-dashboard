# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ PyToyoda - –û—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

## üêõ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

#### 1.1 –û–ø–µ—á–∞—Ç–∫–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∞–π–ª–æ–≤
- **–§–∞–π–ª**: `pytoyoda/models/nofication.py`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ (–ø—Ä–æ–ø—É—â–µ–Ω–∞ –±—É–∫–≤–∞ 't')
- **–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**: `notification.py`
- **–í–ª–∏—è–Ω–∏–µ**: –ù–∞—Ä—É—à–∞–µ—Ç —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ –∏ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—É

#### 1.2 –û–ø–µ—á–∞—Ç–∫–∏ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö
- **–§–∞–π–ª**: `pytoyoda/const.py:28`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `VEHICLE_SERVICE_HISTORY_ENDPONT` (–ø—Ä–æ–ø—É—â–µ–Ω–∞ –±—É–∫–≤–∞ 'I')
- **–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**: `VEHICLE_SERVICE_HISTORY_ENDPOINT`
- **–í–ª–∏—è–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö, –≤–∫–ª—é—á–∞—è API –∏ —Ç–µ—Å—Ç—ã

#### 1.3 –û–ø–µ—á–∞—Ç–∫–∏ –≤ docstrings
- **–§–∞–π–ª**: `pytoyoda/exceptions.py:17,21`
- **–ü—Ä–æ–±–ª–µ–º–∞**: "occurres" –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "occurs"
- **–í–ª–∏—è–Ω–∏–µ**: –°–Ω–∏–∂–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
- **–§–∞–π–ª**: `pytoyoda/models/vehicle.py`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `from pytoyoda.models.nofication import Notification`
- **–í–ª–∏—è–Ω–∏–µ**: –°—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ñ–∞–π–ª —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º

### 3. –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 3.1 –•–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ API –∫–ª—é—á–∏
- **–§–∞–π–ª**: `pytoyoda/controller.py:391-392`
- **–ü—Ä–æ–±–ª–µ–º–∞**: API –∫–ª—é—á–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã –≤ –∫–æ–¥–µ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –í—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### 3.2 URL –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
- **–§–∞–π–ª**: `pytoyoda/const.py:7-12`
- **–ü—Ä–æ–±–ª–µ–º–∞**: HTTPS –Ω–∞–ø–∏—Å–∞–Ω–æ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
- **–í–ª–∏—è–Ω–∏–µ**: –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö HTTP –∫–ª–∏–µ–Ω—Ç–∞—Ö

## üöÄ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 1.1 –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
```python
# –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
class ToyotaRateLimitError(ToyotaApiError):
    """Raise when rate limit is exceeded."""

class ToyotaTimeoutError(ToyotaApiError):
    """Raise when request times out."""
```

#### 1.2 Retry –ª–æ–≥–∏–∫–∞
```python
# –î–æ–±–∞–≤–∏—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
@retry(max_attempts=3, backoff_factor=2)
async def request_with_retry(self, ...):
    pass
```

#### 1.3 Rate Limiting
```python
# –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
from asyncio import Semaphore

class Controller:
    def __init__(self, ...):
        self._rate_limiter = Semaphore(10)  # 10 concurrent requests
```

### 2. –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 2.1 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è API –∫–ª—é—á–µ–π
```python
import os

API_KEY = os.getenv("TOYOTA_API_KEY", "default_key")
```

#### 2.2 –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```python
from pydantic import validator

class MyT:
    @validator('username')
    def validate_email(cls, v):
        if '@' not in v:
            raise ValueError('Invalid email format')
        return v
```

### 3. –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 3.1 Connection Pooling
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å connection pooling –¥–ª—è HTTP –∫–ª–∏–µ–Ω—Ç–∞
async with httpx.AsyncClient(
    limits=httpx.Limits(max_keepalive_connections=20)
) as client:
    pass
```

#### 3.2 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
```python
# –î–æ–±–∞–≤–∏—Ç—å TTL –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
from functools import lru_cache
from datetime import datetime, timedelta

@lru_cache(maxsize=128)
def cached_vehicle_data(vin: str, timestamp: int):
    pass
```

### 4. –£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

#### 4.1 –ë–æ–ª—å—à–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
```python
from typing import TypeVar, Generic, Optional, Union
from collections.abc import Sequence

T = TypeVar('T')

class ApiResponse(Generic[T]):
    def __init__(self, data: T, status: int) -> None:
        self.data = data
        self.status = status
```

#### 4.2 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger.bind(
    vin=vehicle.vin,
    operation="get_status",
    user_id=self._username
).info("Fetching vehicle status")
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 5.1 –ë–æ–ª—å—à–µ unit —Ç–µ—Å—Ç–æ–≤
```python
# –¢–µ—Å—Ç—ã –¥–ª—è edge cases
@pytest.mark.asyncio
async def test_token_refresh_failure():
    # Test token refresh failure scenario
    pass

@pytest.mark.asyncio  
async def test_rate_limit_handling():
    # Test rate limit handling
    pass
```

#### 5.2 Integration —Ç–µ—Å—Ç—ã
```python
# –¢–µ—Å—Ç—ã —Å mock API
@pytest.mark.asyncio
async def test_full_workflow():
    # Test complete workflow from login to data retrieval
    pass
```

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### 6.1 –£–ª—É—á—à–∏—Ç—å README
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å troubleshooting —Å–µ–∫—Ü–∏—é
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ rate limits

#### 6.2 API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –î–æ–±–∞–≤–∏—Ç—å OpenAPI/Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

### 7. CI/CD —É–ª—É—á—à–µ–Ω–∏—è

#### 7.1 GitHub Actions
```yaml
# .github/workflows/test.yml
name: Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.9, 3.10, 3.11, 3.12]
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}
      - name: Install dependencies
        run: |
          pip install poetry
          poetry install
      - name: Run tests
        run: poetry run pytest
      - name: Run linting
        run: poetry run ruff check
```

### 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

#### 8.1 –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
```python
import time
from functools import wraps

def track_api_calls(func):
    @wraps(func)
    async def wrapper(*args, **kwargs):
        start_time = time.time()
        try:
            result = await func(*args, **kwargs)
            # Log successful call
            return result
        except Exception as e:
            # Log failed call
            raise
        finally:
            duration = time.time() - start_time
            # Log duration
    return wrapper
```

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
3. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ API –∫–ª—é—á–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É
2. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
2. –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
3. –î–æ–±–∞–≤–∏—Ç—å CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–í–æ—Ç —Å–ø–∏—Å–æ–∫ –±—ã—Å—Ç—Ä—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

1. ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `nofication.py` –≤ `notification.py` - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å `ENDPONT` –Ω–∞ `ENDPOINT` - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å "occurres" –Ω–∞ "occurs" - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã - **–ò–°–ü–†–ê–í–õ–ï–ù–û**
5. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å URL —Å HTTPS –Ω–∞ https - **–ò–°–ü–†–ê–í–õ–ï–ù–û**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã! –ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.

## üìä –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –û–ø–µ—á–∞—Ç–∫–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞—Ö
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- –û–ø–µ—á–∞—Ç–∫–∏ –≤ docstrings
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º URL
- –î–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞

### üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
–°–æ–∑–¥–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏:
- `SECURITY_IMPROVEMENTS.md` - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `ARCHITECTURE_IMPROVEMENTS.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–≠—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –Ω–∞—Ä—É—à–∞—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞.