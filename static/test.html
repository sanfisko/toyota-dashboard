<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Toyota Test">
    <title>Toyota Test Functions</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 4px solid #007bff;
        }
        
        .section h2 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .section h2::before {
            content: "üîß";
            margin-right: 10px;
            font-size: 18px;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .test-button {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3);
        }
        
        .test-button:active {
            transform: translateY(0);
        }
        
        .test-button.success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
        }
        
        .test-button.error {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }
        
        .test-button.loading {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            cursor: not-allowed;
        }
        
        .test-button.loading::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .window-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .window-individual {
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }
        
        .window-individual h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #495057;
            text-align: center;
        }
        
        .window-buttons {
            display: flex;
            gap: 10px;
        }
        
        .window-btn {
            flex: 1;
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .window-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(108, 117, 125, 0.3);
        }
        
        .climate-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .temp-control {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .temp-display {
            font-size: 24px;
            font-weight: bold;
            color: #1976d2;
            margin: 10px 0;
        }
        
        .temp-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .temp-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #1976d2;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .temp-btn:hover {
            background: #1565c0;
            transform: scale(1.1);
        }
        
        .log-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 4px solid #28a745;
        }
        
        .log-section h2 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .log-section h2::before {
            content: "üìã";
        }
        
        .log-container {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 8px;
            padding: 5px;
            border-radius: 5px;
        }
        
        .log-entry.success {
            background: #d4edda;
            color: #155724;
            border-left: 3px solid #28a745;
        }
        
        .log-entry.error {
            background: #f8d7da;
            color: #721c24;
            border-left: 3px solid #dc3545;
        }
        
        .log-entry.info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 3px solid #17a2b8;
        }
        
        .clear-log {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .clear-log:hover {
            background: #5a6268;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        .back-link::before {
            content: "‚Üê ";
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏</a>
        
        <div class="header">
            <h1>üöó –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π Toyota</h1>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º</p>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–µ—Ä—è–º–∏ –∏ –∑–∞–º–∫–∞–º–∏ -->
        <div class="section">
            <h2>–î–≤–µ—Ä–∏ –∏ –∑–∞–º–∫–∏</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('door-lock')">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–≤–µ—Ä–∏</button>
                <button class="test-button" onclick="sendCommand('door-unlock')">üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–≤–µ—Ä–∏</button>
                <button class="test-button" onclick="sendCommand('trunk-lock')">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–∞–≥–∞–∂–Ω–∏–∫</button>
                <button class="test-button" onclick="sendCommand('trunk-unlock')">üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–∞–≥–∞–∂–Ω–∏–∫</button>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–≥–∞—Ç–µ–ª–µ–º -->
        <div class="section">
            <h2>–î–≤–∏–≥–∞—Ç–µ–ª—å</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('engine-start')">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—å</button>
                <button class="test-button" onclick="sendCommand('engine-stop')">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—å</button>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞–º–∏ -->
        <div class="section">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞–º–∏</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('power-window-on')">ü™ü –û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –æ–∫–Ω–∞</button>
                <button class="test-button" onclick="sendCommand('power-window-off')">ü™ü –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ–∫–Ω–∞</button>
            </div>
            
            <h3 style="margin-top: 20px; margin-bottom: 15px; color: #495057;">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–∞–º–∏</h3>
            <div class="window-controls">
                <div class="window-individual">
                    <h3>–ü–µ—Ä–µ–¥–Ω–µ–µ –ª–µ–≤–æ–µ –æ–∫–Ω–æ</h3>
                    <div class="window-buttons">
                        <button class="window-btn" onclick="sendWindowCommand('front-left', 'open')">–û—Ç–∫—Ä—ã—Ç—å</button>
                        <button class="window-btn" onclick="sendWindowCommand('front-left', 'close')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
                <div class="window-individual">
                    <h3>–ü–µ—Ä–µ–¥–Ω–µ–µ –ø—Ä–∞–≤–æ–µ –æ–∫–Ω–æ</h3>
                    <div class="window-buttons">
                        <button class="window-btn" onclick="sendWindowCommand('front-right', 'open')">–û—Ç–∫—Ä—ã—Ç—å</button>
                        <button class="window-btn" onclick="sendWindowCommand('front-right', 'close')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
                <div class="window-individual">
                    <h3>–ó–∞–¥–Ω–µ–µ –ª–µ–≤–æ–µ –æ–∫–Ω–æ</h3>
                    <div class="window-buttons">
                        <button class="window-btn" onclick="sendWindowCommand('rear-left', 'open')">–û—Ç–∫—Ä—ã—Ç—å</button>
                        <button class="window-btn" onclick="sendWindowCommand('rear-left', 'close')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
                <div class="window-individual">
                    <h3>–ó–∞–¥–Ω–µ–µ –ø—Ä–∞–≤–æ–µ –æ–∫–Ω–æ</h3>
                    <div class="window-buttons">
                        <button class="window-btn" onclick="sendWindowCommand('rear-right', 'open')">–û—Ç–∫—Ä—ã—Ç—å</button>
                        <button class="window-btn" onclick="sendWindowCommand('rear-right', 'close')">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û—Å–≤–µ—â–µ–Ω–∏–µ -->
        <div class="section">
            <h2>–û—Å–≤–µ—â–µ–Ω–∏–µ</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('headlight-on')">üí° –í–∫–ª—é—á–∏—Ç—å —Ñ–∞—Ä—ã</button>
                <button class="test-button" onclick="sendCommand('headlight-off')">üí° –í—ã–∫–ª—é—á–∏—Ç—å —Ñ–∞—Ä—ã</button>
                <button class="test-button" onclick="sendCommand('hazard-on')">‚ö†Ô∏è –í–∫–ª—é—á–∏—Ç—å –∞–≤–∞—Ä–∏–π–∫—É</button>
                <button class="test-button" onclick="sendCommand('hazard-off')">‚ö†Ô∏è –í—ã–∫–ª—é—á–∏—Ç—å –∞–≤–∞—Ä–∏–π–∫—É</button>
            </div>
        </div>

        <!-- –ó–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã -->
        <div class="section">
            <h2>–ó–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('sound-horn')">üìØ –ó–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª</button>
                <button class="test-button" onclick="sendCommand('buzzer-warning')">üîî –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏–π —Å–∏–≥–Ω–∞–ª</button>
                <button class="test-button" onclick="sendCommand('find-vehicle')">üîç –ù–∞–π—Ç–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—å</button>
            </div>
        </div>

        <!-- –ö–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—å -->
        <div class="section">
            <h2>–ö–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—å</h2>
            <div class="button-grid">
                <button class="test-button" onclick="sendCommand('ac-settings-on')">‚ùÑÔ∏è –í–∫–ª—é—á–∏—Ç—å –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä</button>
                <button class="test-button" onclick="sendCommand('ventilation-on')">üå¨Ô∏è –í–∫–ª—é—á–∏—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—é</button>
                <button class="test-button" onclick="testClimateStatus()">üìä –°—Ç–∞—Ç—É—Å –∫–ª–∏–º–∞—Ç–∞</button>
                <button class="test-button" onclick="testClimateSettings()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–º–∞—Ç–∞</button>
            </div>
            
            <div class="climate-controls">
                <div class="temp-control">
                    <h3>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</h3>
                    <div class="temp-display" id="tempDisplay">22¬∞C</div>
                    <div class="temp-buttons">
                        <button class="temp-btn" onclick="changeTemp(-1)">-</button>
                        <button class="temp-btn" onclick="changeTemp(1)">+</button>
                    </div>
                </div>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <button class="test-button" onclick="updateClimateSettings()">üíæ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    <button class="test-button" onclick="refreshClimateStatus()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                </div>
            </div>
        </div>

        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
        <div class="section">
            <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
            <div class="button-grid">
                <button class="test-button" onclick="testVehicleStatus()">üìä –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è</button>
                <button class="test-button" onclick="testLocation()">üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</button>
                <button class="test-button" onclick="testElectricStatus()">üîã –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å</button>
                <button class="test-button" onclick="testTelemetry()">üìà –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è</button>
                <button class="test-button" onclick="testNotifications()">üì¨ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
                <button class="test-button" onclick="testServiceHistory()">üîß –ò—Å—Ç–æ—Ä–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</button>
            </div>
        </div>

        <!-- –õ–æ–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div class="log-section">
            <h2>–õ–æ–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <button class="clear-log" onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
            <div class="log-container" id="logContainer">
                <div class="log-entry info">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–π...</div>
            </div>
        </div>
    </div>

    <script>
        let currentTemp = 22;
        
        function updateTempDisplay() {
            document.getElementById('tempDisplay').textContent = currentTemp + '¬∞C';
        }
        
        function changeTemp(delta) {
            currentTemp += delta;
            if (currentTemp < 16) currentTemp = 16;
            if (currentTemp > 30) currentTemp = 30;
            updateTempDisplay();
        }
        
        function addLog(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function clearLog() {
            const logContainer = document.getElementById('logContainer');
            logContainer.innerHTML = '<div class="log-entry info">–õ–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
        }
        
        function setButtonState(button, state) {
            button.classList.remove('success', 'error', 'loading');
            if (state) {
                button.classList.add(state);
            }
            
            if (state === 'loading') {
                button.disabled = true;
                button.textContent = '';
            } else {
                button.disabled = false;
                setTimeout(() => {
                    button.classList.remove('success', 'error');
                }, 3000);
            }
        }
        
        async function sendCommand(command, beeps = 0) {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog(`–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã: ${command}${beeps > 0 ? ` (${beeps} —Å–∏–≥–Ω–∞–ª–æ–≤)` : ''}`, 'info');
            
            try {
                const response = await fetch('/api/test/command', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        command: command,
                        beeps: beeps
                    })
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –ö–æ–º–∞–Ω–¥–∞ "${command}" –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã "${command}": ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã "${command}": ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function sendWindowCommand(window, action) {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog(`–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∫–Ω–æ–º: ${window} - ${action}`, 'info');
            
            try {
                const response = await fetch('/api/test/window', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        window: window,
                        action: action
                    })
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –û–∫–Ω–æ "${window}" - –¥–µ–π—Å—Ç–≤–∏–µ "${action}" –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–∫–Ω–æ–º "${window}": ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ–∫–Ω–æ–º "${window}": ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function testClimateStatus() {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—è...', 'info');
            
            try {
                const response = await fetch('/api/test/climate/status');
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –°—Ç–∞—Ç—É—Å –∫–ª–∏–º–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω: ${JSON.stringify(result.data, null, 2)}`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞: ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function testClimateSettings() {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog('–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—è...', 'info');
            
            try {
                const response = await fetch('/api/test/climate/settings');
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–º–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω—ã: ${JSON.stringify(result.data, null, 2)}`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç–∞: ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function updateClimateSettings() {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog(`–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç–∞: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ${currentTemp}¬∞C`, 'info');
            
            try {
                const response = await fetch('/api/test/climate/settings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        temperature: currentTemp,
                        settings_on: true,
                        temperature_unit: 'C'
                    })
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–º–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ${currentTemp}¬∞C`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–ª–∏–º–∞—Ç–∞: ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function refreshClimateStatus() {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog('–ó–∞–ø—Ä–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞ —Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è...', 'info');
            
            try {
                const response = await fetch('/api/test/climate/refresh', {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ –ó–∞–ø—Ä–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–º–∞—Ç–∞: ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        async function testVehicleStatus() {
            await testGenericEndpoint('/api/test/status', '–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–æ–±–∏–ª—è');
        }
        
        async function testLocation() {
            await testGenericEndpoint('/api/test/location', '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ');
        }
        
        async function testElectricStatus() {
            await testGenericEndpoint('/api/test/electric', '–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å');
        }
        
        async function testTelemetry() {
            await testGenericEndpoint('/api/test/telemetry', '–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è');
        }
        
        async function testNotifications() {
            await testGenericEndpoint('/api/test/notifications', '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
        }
        
        async function testServiceHistory() {
            await testGenericEndpoint('/api/test/service-history', '–ò—Å—Ç–æ—Ä–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è');
        }
        
        async function testGenericEndpoint(endpoint, name) {
            const button = event.target;
            const originalText = button.textContent;
            
            setButtonState(button, 'loading');
            addLog(`–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: ${name}...`, 'info');
            
            try {
                const response = await fetch(endpoint);
                const result = await response.json();
                
                if (response.ok && result.success) {
                    setButtonState(button, 'success');
                    addLog(`‚úÖ ${name} –ø–æ–ª—É—á–µ–Ω: ${JSON.stringify(result.data, null, 2)}`, 'success');
                } else {
                    setButtonState(button, 'error');
                    addLog(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ${name}: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`, 'error');
                }
            } catch (error) {
                setButtonState(button, 'error');
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ ${name}: ${error.message}`, 'error');
            }
            
            button.textContent = originalText;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateTempDisplay();
        addLog('–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!', 'success');
    </script>
</body>
</html>